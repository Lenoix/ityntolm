#!/bin/sh

# Runs grub-install with the correct arguments for UEFI systems that do not
# have more than one operating system per EFI system partition.
#
# Note: grub-efi-amd64 must be installed.

set -e

# On a dual-boot system, Windows may remove our Linux boot entry from the
# NVRAM Boot* variables after a Windows install or a Windows Update.
# Use --force-extra-removable to ensure we have a copy of grubx64.efi at
# the fallback boot location /EFI/BOOT/BOOTX64.EFI used by almost all UEFI
# motherboards.  See 3.5.1.1 Removable Media Boot Behavior
# http://www.uefi.org/sites/default/files/resources/UEFI%20Spec%202_6.pdf
grub-install --target=x86_64-efi --efi-directory=/boot/efi --force-extra-removable --bootloader-id=Linux --recheck
