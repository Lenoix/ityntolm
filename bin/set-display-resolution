#!/bin/bash

set -eu

width=$1
height=$2
refresh=$3
modeline=$(gtf $width $height $refresh | grep -o 'Modeline .*' | cut -f 3- -d ' ')
# 2> /dev/null to ignore cryptic complaint about mode already existing
xrandr --newmode                  ${width}x${height}@${refresh} $modeline 2> /dev/null
xrandr --addmode Virtual-0        ${width}x${height}@${refresh}
xrandr --output  Virtual-0 --mode ${width}x${height}@${refresh}
