#!/usr/bin/python -SB

import argparse
import subprocess
import StringIO

parser = argparse.ArgumentParser()
parser.add_argument("--port", "-p", default=443)
parser.add_argument("host")
args = parser.parse_args()

# TODO: Test IPv6 support

p = subprocess.Popen(
	["openssl", "s_client", "-showcerts", "-connect", args.host + ":" + str(args.port)],
	stdin=subprocess.PIPE)
p.communicate(input='')
