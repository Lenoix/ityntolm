#!/bin/bash

# Like screen -R, but don't create a new tmux session if there's nothing
# to attach to.
#
# If given an argument, run `tmux attach -t ARGUMENT` instead of attaching
# to the first unattached session.

if [ -n "$1" ]; then
	exec tmux attach -t "$1"
fi

tmux ls | grep -vq ' (attached)$'
if [ "$?" = 0 ]; then
    exec tmux attach
else
    >&2 echo "All sessions already attached."
fi
